<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Portfolio Atomique - Tâches vivantes</title>
  <style>
    body { margin: 0; overflow: hidden; background: white; font-family: sans-serif; }
    svg { width: 100vw; height: 100vh; display: block; }
    .tooltip {
      position: absolute;
      background: rgba(255, 255, 255, 0.85);
      border: 1px solid #ccc;
      padding: 10px;
      font-size: 14px;
      pointer-events: none;
      box-shadow: 0px 2px 10px rgba(0,0,0,0.2);
      border-radius: 8px;
      transition: opacity 0.2s ease;
    }
  </style>
</head>
<body>
<div class="tooltip" style="opacity: 0;"></div>
<svg></svg>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
const width = window.innerWidth;
const height = window.innerHeight;

const totalNodes = 100; // Total de tâches visuelles

const keyNodes = [
  {
    id: "Formateur Manager",
    type: "poste",
    skills: ["Analyser", "Accompagnement", "Encadrement", "Évaluation", "Animation"]
  },
  {
    id: "Enseignant INFOCOM",
    type: "poste",
    skills: ["Pédagogie", "Médiation", "Groupe", "Prépa cours", "Communication"]
  },
  {
    id: "Gérant PNP",
    type: "poste",
    skills: ["Stratégie", "Informatique", "Finances", "Client", "Entrepreneuriat"]
  },
  {
    id: "Licence Pro Commerce",
    type: "diplome",
    skills: ["E-commerce", "Marketing", "Vente", "Marché", "Visuel"]
  },
  {
    id: "Master Humanités Num.",
    type: "diplome",
    skills: ["Design", "Culture numérique", "Industries", "Analyse", "Recherche"]
  },
  {
    id: "Stage Maraîchage",
    type: "poste",
    skills: ["Horticulture", "Durabilité", "Manuel", "Cahier des charges", "Végétaux"]
  },
  {
    id: "Feng Shui",
    type: "formation",
    skills: ["Espaces", "Énergie", "Plans", "Symboles", "Harmonie"]
  },
  {
    id: "Écriture / Poésie",
    type: "centre",
    skills: ["Création", "Langue", "Inspiration", "Multilingue", "Expression libre"]
  },
  {
    id: "Nature & objets",
    type: "centre",
    skills: ["Observation", "Sculpture", "Réflexion", "Esthétique", "Respect vivant"]
  }
];

// Palette douce inspirée de l’image
const colors = [
  "#FFA07A", "#87CEFA", "#90EE90", "#FFD700",
  "#FF69B4", "#20B2AA", "#9370DB", "#F08080",
  "#B0C4DE", "#FF8C00"
];

const tooltip = d3.select(".tooltip");
const svg = d3.select("svg");

const allNodes = Array.from({ length: totalNodes }, (_, i) => {
  const data = keyNodes[i] || null;
  return {
    id: data?.id || null,
    skills: data?.skills || [],
    isKey: !!data,
    color: data ? colors[i % colors.length] : "rgba(0,0,0,0.7)",
    rx: 20 + Math.random() * 20,
    ry: 12 + Math.random() * 15,
    rotation: Math.random() * 360
  };
});

const simulation = d3.forceSimulation(allNodes)
  .force("charge", d3.forceManyBody().strength(-60))
  .force("center", d3.forceCenter(width / 2, height / 2))
  .force("collision", d3.forceCollide().radius(d => d.rx + 3))
  .on("tick", ticked);

const node = svg.selectAll("ellipse")
  .data(allNodes)
  .enter().append("ellipse")
  .attr("rx", d => d.rx)
  .attr("ry", d => d.ry)
  .attr("transform", d => `rotate(${d.rotation})`)
  .attr("fill", d => d.color)
  .style("cursor", d => d.isKey ? "pointer" : "default")
  .on("mouseover", function(event, d) {
    if (d.isKey) {
      tooltip
        .style("opacity", 1)
        .html(`
          <div style="color:${d.color}; font-weight:bold;">${d.id}</div>
          <ul style="margin:0; padding-left:16px;">
            ${d.skills.map(s => `<li>${s}</li>`).join("")}
          </ul>`);
    }
  })
  .on("mousemove", function(event) {
    tooltip
      .style("left", (event.pageX + 15) + "px")
      .style("top", (event.pageY - 20) + "px");
  })
  .on("mouseout", function(event, d) {
    tooltip.style("opacity", 0);
  });

function ticked() {
  node
    .attr("cx", d => d.x)
    .attr("cy", d => d.y);
}
</script>
</body>
</html>
