<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Portfolio Atomique - Tâches flottantes</title>
  <style>
    body { margin: 0; overflow: hidden; background: white; font-family: sans-serif; }
    svg { width: 100vw; height: 100vh; display: block; }
    .tooltip {
      position: absolute;
      background: rgba(255,255,255,0.95);
      border: 1px solid #ccc;
      padding: 10px;
      font-size: 14px;
      pointer-events: none;
      box-shadow: 0px 2px 10px rgba(0,0,0,0.2);
      border-radius: 8px;
    }
  </style>
</head>
<body>
<div class="tooltip" style="opacity: 0;"></div>
<svg></svg>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
const width = window.innerWidth;
const height = window.innerHeight;

const totalNodes = 100; // comme sur ton image (approximatif)
const diplomaNodes = [
  {
    id: "Formateur Manager",
    skills: ["Analyser", "Accompagnement", "Encadrement", "Évaluation", "Animation"]
  },
  {
    id: "Enseignant INFOCOM",
    skills: ["Pédagogie", "Médiation", "Groupe", "Prépa cours", "Communication"]
  },
  {
    id: "Gérant PNP",
    skills: ["Stratégie", "Informatique", "Finances", "Client", "Entrepreneuriat"]
  },
  {
    id: "Licence Pro Commerce",
    skills: ["E-commerce", "Marketing", "Vente", "Marché", "Visuel"]
  },
  {
    id: "Master Humanités Num.",
    skills: ["Design", "Culture numérique", "Industries", "Analyse", "Recherche"]
  },
  {
    id: "Stage Maraîchage",
    skills: ["Horticulture", "Durabilité", "Manuel", "Cahier des charges", "Végétaux"]
  },
  {
    id: "Feng Shui",
    skills: ["Espaces", "Énergie", "Plans", "Symboles", "Harmonie"]
  }
];

const palette = d3.schemePaired;
const tooltip = d3.select(".tooltip");
const svg = d3.select("svg");

const allNodes = Array.from({ length: totalNodes }, (_, i) => {
  const d = diplomaNodes[i] || null;
  return {
    id: d?.id || null,
    skills: d?.skills || [],
    isMain: !!d,
    group: i,
    rx: 20 + Math.random() * 20,
    ry: 12 + Math.random() * 15,
    rotation: Math.random() * 360
  };
});

const simulation = d3.forceSimulation(allNodes)
  .force("charge", d3.forceManyBody().strength(-50))
  .force("center", d3.forceCenter(width / 2, height / 2))
  .force("collision", d3.forceCollide().radius(d => d.rx + 4))
  .on("tick", ticked);

const node = svg.selectAll("ellipse")
  .data(allNodes)
  .enter().append("ellipse")
  .attr("rx", d => d.rx)
  .attr("ry", d => d.ry)
  .attr("transform", d => `rotate(${d.rotation})`)
  .attr("fill", "rgba(0, 0, 0, 0.7)")
  .style("cursor", d => d.isMain ? "pointer" : "default")
  .on("mouseover", function(event, d) {
    if (d.isMain) {
      d3.select(this).attr("fill", palette[d.group % palette.length]);
      tooltip
        .style("opacity", 1)
        .html(`<strong>${d.id}</strong><br><ul>${d.skills.map(s => `<li>${s}</li>`).join("")}</ul>`)
        .style("left", (event.pageX + 15) + "px")
        .style("top", (event.pageY - 20) + "px");
    }
  })
  .on("mousemove", function(event) {
    tooltip.style("left", (event.pageX + 15) + "px")
           .style("top", (event.pageY - 20) + "px");
  })
  .on("mouseout", function(event, d) {
    d3.select(this).attr("fill", "rgba(0, 0, 0, 0.7)");
    tooltip.style("opacity", 0);
  });

function ticked() {
  node
    .attr("cx", d => d.x)
    .attr("cy", d => d.y);
}
</script>
</body>
</html>
