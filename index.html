<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Portfolio • Didier Basque</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f3f3f3;
    }
    svg {
      width: 100vw;
      height: 100vh;
      display: block;
    }
    .tooltip {
      position: absolute;
      max-width: 300px;
      background: rgba(20,20,20,0.92);
      color: white;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      font-size: 14px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .tooltip h3 {
      margin: 0 0 0.5rem;
      font-size: 16px;
    }
    .signature {
      position: absolute;
      bottom: 20px;
      left: 30px;
      color: #222;
      font-size: 13px;
      max-width: 300px;
    }
    .signature strong {
      font-size: 16px;
      color: #ff5500;
    }
    .filter-bar {
      position: absolute;
      top: 20px;
      left: 30px;
      display: flex;
      gap: 10px;
    }
    .filter-bar button {
      background: #fff;
      border: 1px solid #aaa;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
    }
    .filter-bar button.active {
      background: #ff5500;
      color: white;
      border-color: #ff5500;
    }
  </style>
</head>
<body>
<div class="tooltip"></div>
<div class="filter-bar"></div>
<svg></svg>
<div class="signature">
  <strong>PORTFOLIO • Didier Basque</strong>
  Une exploration graphique de mes pratiques professionnelles et artistiques.
  Chaque cercle est une trace, un mouvement, une mémoire mise en forme pour dire le sens de mes engagements.
</div>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
const svg = d3.select("svg");
const tooltip = d3.select(".tooltip");
const width = window.innerWidth;
const height = window.innerHeight;
const filters = ['Tous', 'Poste', 'Diplôme', 'Interets', 'Mémoire'];

const keyNodes = [
  { id: "Formateur Manager", group: "Poste", color: "#FF6B6B", text: "J'ai appris à encadrer avec écoute et efficacité, pour révéler les potentiels." },
  { id: "Master Humanités Num.", group: "Diplôme", color: "#4ECDC4", text: "Ce master m'aide à penser la technologie comme vecteur culturel." },
  { id: "Mémoire Sentier Augmenté", group: "Mémoire", color: "#00A896", strokeOnly: true, text: "Mon mémoire propose de numériser les traces culturelles du Bassin Vital pour réactiver la mémoire collective à La Réunion via un parcours augmenté." },
  { id: "Licence Pro Commerce", group: "Diplôme", color: "#A163F2", text: "Cette formation m'a permis de relier créativité et logique de marché." },
  { id: "Stage Maraîchage", group: "Poste", color: "#FFD166", text: "Travailler la terre m'a appris rigueur et respect du rythme naturel." },
  { id: "Nature & objets", group: "Interets", color: "#EF476F", text: "Je m'inspire de la nature pour transformer et revaloriser les objets." }
];

const allNodes = d3.range(200).map((_, i) => {
  const k = keyNodes[i];
  return {
    id: k?.id || null,
    group: k?.group || null,
    text: k?.text || null,
    isKey: !!k,
    color: k?.color || '#ccc',
    radius: k ? 15 + Math.random() * 15 : 4 + Math.random() * 8,
    strokeOnly: !!k?.strokeOnly,
    visible: true
  };
});

let simulation = d3.forceSimulation(allNodes)
  .force("charge", d3.forceManyBody().strength(-30))
  .force("center", d3.forceCenter(width / 2, height / 2))
  .force("collision", d3.forceCollide().radius(d => d.radius + 2))
  .on("tick", ticked);

const node = svg.selectAll("circle")
  .data(allNodes)
  .enter().append("circle")
  .attr("r", d => d.radius)
  .attr("fill", d => d.strokeOnly ? "none" : d.color)
  .attr("stroke", d => d.strokeOnly ? d.color : "none")
  .attr("stroke-width", d => d.strokeOnly ? 2 : 0)
  .attr("opacity", d => d.isKey ? 1 : 0.4)
  .on("mouseover", function(event, d) {
    if (d.isKey) {
      tooltip
        .style("opacity", 1)
        .html(`<h3 style="color:${d.color}">${d.id}</h3><p>${d.text}</p>`);
    }
  })
  .on("mousemove", function(event) {
    tooltip.style("left", (event.pageX + 10) + "px").style("top", (event.pageY - 20) + "px");
  })
  .on("mouseout", () => tooltip.style("opacity", 0));

function ticked() {
  node.attr("cx", d => d.x).attr("cy", d => d.y).attr("display", d => d.visible ? null : "none");
}

// Filter buttons
const bar = d3.select(".filter-bar");
filters.forEach(f => {
  bar.append("button")
    .text(f)
    .attr("class", f === "Tous" ? "active" : "")
    .on("click", function() {
      d3.selectAll(".filter-bar button").classed("active", false);
      d3.select(this).classed("active", true);
      allNodes.forEach(d => {
        d.visible = (f === "Tous") || (d.group === f);
      });
      simulation.alpha(1).restart();
    });
});
</script>
</body>
</html>
